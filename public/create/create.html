<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="../assets/favicon.ico" type="image/x-icon">
    <title>Create Pecha</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="../toast_style.css" />
    <link rel="stylesheet" href="../custom/calendar/calendar_style.css" />
    <link rel="stylesheet" href="../navbar.css" />
    <link rel="stylesheet" href="../select.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
  </head>
  <body>
    <nav class="navbar">
      <div class="nav-container">
        <a href="/" class="nav-logo">
          <img src="../assets/logo.svg" alt="OpenPecha Logo" />
          <span>OpenPecha</span>
        </a>
        <div class="nav-links">
          <a href="/create/create" class="nav-link active">Create</a>
          <a href="/publish/publish" class="nav-link">Publish</a>
          <a href="/update/" class="nav-link">Update</a>
          <a href="/category/" class="nav-link">Category</a>
          <a href="/annotation/" class="nav-link">Annotation</a>
        </div>
      </div>
    </nav>
    <div id="toastContainer"></div>
    <div id="popupContainer" class="popup-container">
      <div class="popup-content">
        <div id="closePopup" class="close-popup">
          <i class="fas fa-times"></i>
        </div>
        <div class="popup-text">
          <span id="pechaIdText">I2A0B8B81 - དབུ་མ་འཇུག་པ་ལས་སེམས་བསྐྱེད་དྲུག་པ། ཤོ་ལོ་ཀ ༡ ནས་ ༦༤</span>
          <button type="button" id="copyPechaId">
            <i class="fas fa-copy"></i>
          </button>
        </div>
      </div>
    </div>
    <main>
      <div class="container">
        <div class="base-language">
          <label for="baseLanguage">Language of Text:</label>
          <select id="baseLanguage">
          </select>
          <div id="baseLanguageLoader" class="spinner"></div>
        </div>

        <div id="formContent" class="form-content">
          <form id="metadataForm">
            <div class="form-group" data-field="author">
              <label>Author</label>
              <div class="localizations"></div>
              <button type="button" class="add-localization">
                <i class="fas fa-plus-circle"></i>
                Add Author
              </button>
            </div>

            <!-- // custom date picker -->
            <div class="form-group">
              <label>Composition Date</label>
              <div class="date-display" id="selectedDate">No date selected</div>
              <div class="date-picker-container" id="datePickerContainer">
                <div class="era-selector">
                  <label>Era: </label>
                  <select id="eraSelect" class="era-select">
                    <option value="Standard">Standard</option>
                    <option value="BCE">BCE</option>
                    <option value="CE">CE</option>
                  </select>
                </div>

                <div id="standardPicker">
                  <div class="calendar-header">
                    <button type="button" id="prevYear">◄◄</button>
                    <button type="button" id="prevMonth">◄</button>
                    <!-- <span id="currentMonth">January 2024</span> -->
                    <div class="month-year-container">
                      <span id="currentMonth">January 2024</span>
                      <input class="year-select-input" aria-label="Select Year" type="number" min="1" max="9999" id="yearInput"/>
                    </div>
                    <button type="button" id="nextMonth">►</button>
                    <button type="button" id="nextYear">►►</button>
                  </div>

                  <div class="calendar-grid" id="calendarGrid">
                    <!-- Calendar will be generated here -->
                  </div>
                </div>

                <div id="historicalPicker" class="hidden">
                  <div class="year-selector">
                    <label>From: </label>
                    <input
                      type="number"
                      id="historicalYearStart"
                      class="year-input"
                      min="1"
                    />
                    <label>To: </label>
                    <input
                      type="number"
                      id="historicalYearEnd"
                      class="year-input"
                      min="1"
                    />
                  </div>
                  <span class="historical-year-note">* for specific year only first one</span>
                </div>
              </div>
            </div>

            <div class="form-group source-url">
              <label>Source URL</label>
              <div class="input-wrapper">
                <input type="url" placeholder="https://example.com" id="sourceUrl"/>
              </div>
            </div>

            <div class="form-group source">
              <label>Source</label>
              <div class="input-wrapper">
                <input type="text" placeholder="Enter source" id="source"/>
              </div>
            </div>

            <div class="form-group" data-field="presentation">
              <label>Presentation</label>
              <div class="localizations"></div>
              <button type="button" class="add-localization">
                <i class="fas fa-plus-circle"></i>
                Add Presentation
              </button>
            </div>

            <div class="form-group" data-field="usage_title">
              <label>Usage Title</label>
              <div class="localizations"></div>
              <button type="button" class="add-localization">
                <i class="fas fa-plus-circle"></i>
                Add Usage Title
              </button>
            </div>

            <div class="form-group" data-field="title">
              <label>Title</label>
              <div class="localizations">
              </div>
              <button type="button" class="add-localization">
                <i class="fas fa-plus-circle"></i>
                Add Title
              </button>
            </div>

            <div class="form-group" data-field="long_title">
              <label>Long Title</label>
              <div class="localizations"></div>
              <button type="button" class="add-localization">
                <i class="fas fa-plus-circle"></i>
                Add Long Title
              </button>
            </div>

            <div class="form-group">
              <label>Alternate Titles</label>
              <div class="alt-titles" id="alt-titles"></div>
              <button type="button" class="add-alt-title" id="addAltTitle">
                <i class="fas fa-plus-circle"></i>
                <!-- <i class="fa-solid fa-plus"></i> -->
                Add alternate title
              </button>
            </div>

            <div class="form-group">
              <label>Relation</label>
              <div class="radio-group">
                <label class="radio-option">
                  <input type="radio" name="documentType" value="commentary_of" />
                  Commentary of
                </label>
                <label class="radio-option">
                  <input type="radio" name="documentType" value="translation_of" />
                  Translation of
                </label>
                <label class="radio-option">
                  <input type="radio" name="documentType" value="" checked />
                  None
                </label>
              </div>

              <div class="select-wrapper">
                <div id="pechaOptionsContainer" class="select-search-container">
                  <select id="pecha" name="pecha">
                    <option value="">Select pecha</option>
                  </select>
                  <div class="search-overlay">
                    <input
                      type="text"
                      class="search-input"
                      placeholder="Search pechas..."
                    />
                    <div class="search-results"></div>
                  </div>
                </div>
                <!-- Loading spinner for pecha dropdown -->
                <div id="pechaLoadingSpinner" class="loading-spinner">
                  <i class="fas fa-spinner fa-spin"></i> Loading pechas...
                </div>
              </div>
            </div>

            <div class="form-group">
              <label>Annotation Alignment</label>
              <div class="select-wrapper">
                <div id="annotationAlignmentContainer" class="select-search-container">
                  <select id="annotationAlignment" name="annotationAlignment">
                    <option value="">Select annotation alignment</option>
                  </select>
                  <div class="search-overlay">
                    <input
                      type="text"
                      class="search-input"
                      placeholder="Search annotations..."
                    />
                    <div class="search-results"></div>
                  </div>
                </div>
                <div id="annotationLoadingSpinner" class="loading-spinner">
                  <i class="fas fa-spinner fa-spin"></i> Loading annotations...
                </div>
              </div>
            </div>
            <div class="form-group document-id">
              <label>Document</label>
              <div class="input-wrapper">
                <input type="url" placeholder="Google docs URL" />
              </div>
            </div>

            <button type="button" id="createButton" class="create-button">
              <span class="create-button-text">Create</span>
              <div class="spinner"></div>
            </button>
          </form>
          <div class="condition-message">One of them is required</div>
        </div>
      </div>
    </main>
    <script src="script.js"></script>
    <script src="../config.js"></script>
    <script src="../custom/calendar/calendar.js"></script>
    <script src="../google_drive.js"></script>
    <script
      async
      defer
      src="https://apis.google.com/js/api.js"
      onload="gapiLoaded()"
    ></script>
    <script
      async
      defer
      src="https://accounts.google.com/gsi/client"
      onload="gisLoaded()"
    ></script>
  </body>
</html>
